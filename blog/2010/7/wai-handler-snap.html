<p>One area that WAI has been lacking in up until now is a production-quality standalone server for running your applications. We've had CGI and FastCGI when you want to pair up with lightppd or its ilk, and we've had simpleserver for testing purposes. We can now welcome a new member to this family: <a href="http://hackage.haskell.org/package/wai-handler-snap">Snap</a>.</p>
<p>A big thanks to Gregory Collins to making some modifications to Snap so that this shim would be possible. Everything should be installable from cabal without any issues. I've <a href="http://github.com/snoyberg/yesod-hello/blob/master/snap/hello.hs">added a sample to the yesod-hello repository</a>, but it should all be pretty straight-forward.</p>
<p>The code itself is very simple: the only slightly complicated part was converting a WAI enumerator to a Snap enumerator. Also, since a Snap enumerator <i>cannot</i> be converted directly to a Source, the request body uses lazy I/O under the surface.</p>
<p>Below are the obligatory benchmarks for a very simple Sqlite-powered blog. The example is simply loading up a page 1000 times with 20 concurrent connections. The numbers do <b>not</b> necessarily reflect any performance issues with Snap itself; most likely, the performance difference between FastCGI and Snap are due to either issues in the wai-handler-snap layer or, most likely, the runtime arguments I passed to the executable. I'd appreciate feedback on this from people in the know; the <a href="http://github.com/snoyberg/benchmarks/tree/master/yesod/blog/">code is all available on github</a>.</p>
<p><a href="http://www.chartgo.com/linkshare.do?id=f19df9f3aa"><img src="http://www.chartgo.com/link.do?id=80fb66a3aa" alt="Yesod Blog Benchmark" border="0"></a></p>
